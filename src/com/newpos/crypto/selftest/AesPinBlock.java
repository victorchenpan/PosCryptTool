package com.newpos.crypto.selftest;

import com.newpos.crypto.aes.*;
import com.newpos.crypto.format.*;

public class AesPinBlock {
	private static void parsePinBlock() {
		/* 16字节密钥 */
		/*
		byte[] account = new byte[]{0x46,0x26,0x66,0x65,(byte)0x84,0x79,0x51,0x23,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
		byte[] key = new byte[] {(byte)0xA5,0x1B,0x77,0x1D,(byte)0xBB,0x2E,(byte)0xA1,0x67,0x45,(byte)0x8B,(byte)0xE1,(byte)0xB6,0x2B,(byte)0xB1,0x36,0x2A};
		//byte[] cipherPinBlock = new byte[]{(byte)0xCB,(byte)0xC3,(byte)0xD1,(byte)0xC3,0x5F,0x07,0x1A,0x79,0x11,(byte)0xF2,0x6C,(byte)0x92,(byte)0xD8,(byte)0xD8,(byte)0xA9,0x03};
		byte[] cipherPinBlock = new byte[]{0x68,(byte)0xAC,(byte)0xA0,0x0C,(byte)0xEB,0x6C,(byte)0x8E,0x4E,(byte)0xCB,0x58,0x58,0x40,(byte)0x8B,(byte)0xA4,(byte)0xCB,(byte)0xBF};
		*/
		/* 32字节密钥  */
		
		byte[] account = new byte[]{0x46,0x26,0x66,0x65,(byte)0x84,0x79,0x51,0x23,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
		byte[] key = new byte[] {(byte)0x23,(byte)0xDD,(byte)0xF6,(byte)0xA6,0x7D,(byte)0x84,(byte)0xB4,(byte)0xE4,0x59,0x4F,(byte)0xCD,(byte)0xD4,(byte)0xA9,0x45,(byte)0xBD,(byte)0xCE,(byte)0x80,0x5C,0x0A,0x54,(byte)0x87,(byte)0xEB,(byte)0xB8,0x2A,0x54,(byte)0x87,(byte)0xEB,0x4D,(byte)0xF5,0x35,0x73,0x0A};
		//byte[] cipherPinBlock = new byte[]{(byte)0xC7,0x18,(byte)0xBC,(byte)0xAA,(byte)0x8A,(byte)0x8D,0x63,(byte)0xBC,(byte)0xF8,(byte)0x9B,(byte)0x94,0x35,0x7B,(byte)0xA1,(byte)0xAB,(byte)0xFA};
		byte[] cipherPinBlock = new byte[]{(byte)0xD1,0x4F,0x0F,(byte)0xC5,(byte)0xFD,0x09,0x09,0x62,(byte)0xF0,(byte)0x84,(byte)0xE3,0x70,0x31,(byte)0x81,(byte)0xCE,(byte)0xCB};
		
		String mode = "ECB";
		byte[] parsePin = PinBlock.getPlainBlock(account, key, cipherPinBlock, mode);
		System.out.println("AES ECB 解密结果："+HexToString.hexToStr(parsePin));
	}

	private static void getPinBlock() {
		//Test aes get PinBlock
		byte[] account = new byte[]{0x62,0x25,(byte)0x88,0x78,0x00,0x48,0x62,(byte)0x98,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
		byte[] key = new byte[]{0x00,0x00,0x00,0x00,0x00, 0x00, 0x00,0x00,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11};
		byte[] pin = new byte[]{0x45,0x12,0x34,0x5a,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xaa,(byte)0xff,(byte)0xac,0x4f,(byte)0x89,(byte)0xca,0x1a,(byte)0xb8,0x30};
		String mode = "ECB";
		byte[] pinBlock = PinBlock.getCipherBlock(account, key, pin, mode);
		System.out.println("AES ECB 加密结果："+HexToString.hexToStr(pinBlock));
	}

	public static void selfTest() {
		parsePinBlock();
		//getPinBlock();
	}
};
